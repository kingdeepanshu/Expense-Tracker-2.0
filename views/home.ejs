<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link href="/output.css" rel="stylesheet">

    <% function formatDate(date) {
        if (!date) return 'Date Not Available';
        const formattedDate = new Date(date);
        const day = formattedDate.getDate().toString().padStart(2, '0');
        const monthIndex = formattedDate.getMonth(); // Note: getMonth() returns 0-based index
        const monthNames = [
            'January', 'February', 'March', 'April', 'May', 'June',
            'July', 'August', 'September', 'October', 'November', 'December'
        ];
        const monthName = monthNames[monthIndex];
        return `${day} ${monthName}`;
    } %>

</head>
<body class="text-black p-0 m-0 bg-slate-400">
    <header class="bg-slate-800 m-0 p-2 flex justify-between items-center">
        <h1 class="text-white text-xl capitalize text-left font-semibold"><a href="/">expense <br> tracker</a></h1>
        <div class="flex flex-row sm:flex-col">
        <h1 class="text-xs text-white">made by </p>
            <span class="text-sm font-extrabold">Dev Karan</span>
        </div>
    </header>
    <main class="text-black p-3 text-xs" >
        <div class="w-full m-auto border-2 border-black">
            <div class=" flex justify-around">
                <h1 class="inline w-3/12 text-center border-r-2 border-black">Date</h1>
                <h1 class="inline w-4/12 text-center border-r-2 border-black">Description</h1>
                <h1 class="inline w-2/12 text-center border-r-2 border-black">Amount</h1>
                <h1 class="inline w-3/12 text-center">Category</h1>
            </div>
            <% expenses.forEach((expense) => { %>
            <a href="/<%= expense._id %>/" class="block">
                <div class="flex justify-around">
                    <h1 class="inline w-3/12 text-center border-r-2 border-black"><%= formatDate(expense.date) %></h1>
                    <h1 class="inline w-4/12 text-center border-r-2 border-black overflow-hidden capitalize"><%= expense.description %></h1>
                    <h1 class="inline w-2/12 text-center border-r-2 border-black"><%= expense.amount %></h1>
                    <h1 class="inline w-3/12 text-center"><%= expense.category %></h1>
                </div>
            </a>
            <% }); %>
            
            <div class="flex justify-between border-t-2 border-black items-center">
                <h1 class="inline w-7/12 text-left font-semibold px-2">Total:</h1>
                <h1 class="inline w-2/12 text-center text-red-600 font-extrabold text-xl"><%= totalAmount %></h1>
                <h1 class="inline w-3/12 text-center text-red-600 text-2xl"></h1>
            </div>
        </div>
    </main>

    <div class="w-max h-10 p-3 bg-red-600 rounded-full flex justify-center items-center fixed bottom-5 right-5" >

        <h1 class="text-xs text-white font-bold w-full">
            <a href="/add/"> Add An Expense </a>
        </h1>

    </div>
</body>
</html>
